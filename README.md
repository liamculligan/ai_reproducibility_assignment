# AI Reproducibility Assignment

This repository contains the code and resources for the 
University of the Witwatersrand's COMS7044A Reproducibility Assignment 
which aims to replicate and validate experiment 1 
described in the paper "Utilising Uncertainty for 
Efficient Learning of Likely-Admissible Heuristics" 
by Ofir Marom and Benjamin Rosman.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
- [Logging](#logging)
- [Plotting](#plotting)

## Installation

To get started, clone the repository and create a conda 
environment using the provided `environment.yaml` file.

```bash
git clone https://github.com/liamculligan/ai_reproducibility_assignment.git
cd ai_reproducibility_assignment
conda env create -f environment.yaml
conda activate ai_reproducibility_env
```

## Usage

The main script in this repository is train_test_models.py. 
This script handles the training and testing of the models. 
To run the script, use the following command:

```bash
python train_test_models.py
```

This script both trains the feedforward neural network and 
weight uncertain neural network used to produce the learned heursitcs 
as per the apporach of Marom and Rosman (2020). Once the models have 
been trained, they are then applied to a sample of test puzzles to 
compare test the following claim made in the original paper:

The framework which utilises epistemic and aleatoric uncertainty 
to learn likely-admissible heuristics leads to lower sub-optimality 
and more optimal solutions when applied to the 15-puzzle 
compared to traditional heuristic learning methods and the 
Manhattan Distance heuristic.

## Logging

Detailed logs of the entire training and testing process are available. 
In all logs the kappa value used is appended to indicate 
which kappa value produced the logged results.

* detailed_log_kappa_{}.txt - Detailed output of GenerateTaskPrac and LearnHeuristicPrac algorithms
* epistemic_uncertainty_log_kappa_{}.txt - The epistemic uncertainty predicted by the WUNN for every task that could be generated by GenerateTaskPrac
* ffnn_loss_log_kappa_{}.txt - The MSE loss of the feedforwad neural network (FFNN) over time
* summary_log_kappa_{}.txt - A summary of the overall training process
* test_results_log_kappa_{}.txt - The results generated for test puzzle
* wunn_aleatoric_uncertainty_log_kappa_{}.txt - The aleatoric uncertainty predicted by the WUNN for every task that could be generated by GenerateTaskPrac
* wunn_loss_loga_kappa_{}.txt - The custom loss of the WUNN over time
* wunn_prediction_log_kappa_{}.txt - The mean predicted cost to goal from the WUNN

## Plots

Detailed plots of the entire training process are available. 
In all plots the kappa value used is appended to indicate 
which kappa value produced the logged results. 
Where relevant, the iteration number provides the iteration 
number of the main algorithm which is distinct from training 
epoch number.

* ffnn_loss_iteration_{i}_kappa_{}.png - The evolution of MSE loss for the FFNN for the ith iteration by epoch
* median_aleatoric_uncertainty_by_iteration_kappa_{}.png - The median aleatoric uncertainty each iteration from the WUNN
* median_epistemic_uncertainty_by_iteration_kappa_{}.png - The median epistemic uncertainty each iteration from the WUNN
* median_predicted_cost_by_iteration_kappa_{}.png - The median predicted cost to goal from the FFNN
* wunn_loss_iteration_{i}_kappa_{}.png - The evolution of custom loss for the WUNN for the ith iteration by epoch

## Known Issues

The claim investigated could not be verified. This is 
assumed to be because the weight uncertain neural network (WUNN) has not been
implemented correctly in these reproduced version. The epistemic uncertainties
produced by this model are too low, meaning that the training procedure 
cannot continue after two iterations. 

## References

1. Ernandes, M., Gori, M., et al. (2004). Likely-admissible and sub-symbolic heuristics. ECAI, 16, 613.
2. Marom, O., & Rosman, B. (2020). Utilising uncertainty for efficient learning of likely-admissible
heuristics. Proceedings of the International Conference on Automated Planning and Schedul-
ing, 30, 560â€“568.
3. Pearl, J. (1984). Heuristics: Intelligent search strategies for computer problem solving. Addison-
Wesley Longman Publishing Co., Inc.
4. Russell, S., & Norvig, P. (2010). Artificial intelligence: A modern approach (3rd). Prentice Hall.

